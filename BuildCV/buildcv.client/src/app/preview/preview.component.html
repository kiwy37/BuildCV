<!-- Move header outside preview container so it can be full-width and wider -->
<div class="preview-header">
  <div class="preview-title">
    <h2>
      <i class="icon-eye"></i>
      CV Preview & Customization
    </h2>
    <p>Current theme: <strong>{{ selectedTheme | titlecase }}</strong></p>
  </div>

  <div class="preview-actions">
    <button class="btn-secondary" (click)="backToThemeSelection()">
      <i class="icon-arrow-left"></i>
      Change Theme
    </button>

    <button class="btn-secondary btn-customize" (click)="toggleCustomizationPanel()">
      <i class="icon-sliders"></i>
      Customize CV
    </button>

    <div class="zoom-controls">
      <label style="font-size:0.95rem;color:var(--text-secondary);">Zoom: {{ (zoom * 100) | number:'1.0-0' }}%</label>
      <input type="range" min="50" max="150" [value]="zoom * 100" (input)="setZoom($any($event.target).value)" class="slider-zoom">
    </div>

    <button class="btn-primary" (click)="downloadPDF()">
      <i class="icon-download"></i>
      Download PDF
    </button>
  </div>
</div>

<div class="preview-container">
  <!-- Left: customization panel -->
  <div class="customization-sidebar" [class.open]="showCustomizationPanel">
    <div class="sidebar-header">
      <h3>
        <i class="icon-sliders"></i>
        Customize CV
      </h3>
      <button class="btn-close" (click)="toggleCustomizationPanel()">√ó</button>
    </div>

    <div class="sidebar-content">
      <!-- Repeat same content as above - keep one source of truth in the file -->
      <!-- Typography Settings -->
      <div class="setting-group">
        <h4>üìù Typography</h4>
        
        <div class="setting-item">
          <label>Body Font Size: {{customization.fontSize}}px</label>
          <input 
            type="range" 
            [(ngModel)]="customization.fontSize" 
            (input)="onCustomizationChange()"
            min="10" 
            max="18" 
            step="1"
            class="slider">
        </div>

        <div class="setting-item">
          <label>Heading Font Size: {{customization.headingFontSize}}px</label>
          <input 
            type="range" 
            [(ngModel)]="customization.headingFontSize" 
            (input)="onCustomizationChange()"
            min="18" 
            max="32" 
            step="1"
            class="slider">
        </div>

        <div class="setting-item">
          <label>Line Height: {{customization.lineHeight}}</label>
          <input 
            type="range" 
            [(ngModel)]="customization.lineHeight" 
            (input)="onCustomizationChange()"
            min="1.2" 
            max="2.0" 
            step="0.1"
            class="slider">
        </div>

        <div class="setting-item">
          <label>Section Spacing: {{customization.sectionSpacing}}px</label>
          <input 
            type="range" 
            [(ngModel)]="customization.sectionSpacing" 
            (input)="onCustomizationChange()"
            min="10" 
            max="40" 
            step="2"
            class="slider">
        </div>
      </div>

      <!-- Margins -->
      <div class="setting-group">
        <h4>üìè Page Margins</h4>
        
        <div class="spacing-grid">
          <div class="setting-item">
            <label>Top: {{customization.marginTop}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.marginTop" 
              (input)="onCustomizationChange()"
              min="0" 
              max="80" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Bottom: {{customization.marginBottom}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.marginBottom" 
              (input)="onCustomizationChange()"
              min="0" 
              max="80" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Left: {{customization.marginLeft}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.marginLeft" 
              (input)="onCustomizationChange()"
              min="0" 
              max="100" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Right: {{customization.marginRight}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.marginRight" 
              (input)="onCustomizationChange()"
              min="0" 
              max="100" 
              step="5"
              class="slider">
          </div>
        </div>
      </div>

      <!-- Padding -->
      <div class="setting-group">
        <h4>üì¶ Content Padding</h4>
        
        <div class="spacing-grid">
          <div class="setting-item">
            <label>Top: {{customization.paddingTop}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.paddingTop" 
              (input)="onCustomizationChange()"
              min="0" 
              max="80" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Bottom: {{customization.paddingBottom}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.paddingBottom" 
              (input)="onCustomizationChange()"
              min="0" 
              max="80" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Left: {{customization.paddingLeft}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.paddingLeft" 
              (input)="onCustomizationChange()"
              min="0" 
              max="100" 
              step="5"
              class="slider">
          </div>

          <div class="setting-item">
            <label>Right: {{customization.paddingRight}}px</label>
            <input 
              type="range" 
              [(ngModel)]="customization.paddingRight" 
              (input)="onCustomizationChange()"
              min="0" 
              max="100" 
              step="5"
              class="slider">
          </div>
        </div>
      </div>

      <!-- Colors -->
      <div class="setting-group">
        <h4>üé® Colors</h4>
        
        <div class="setting-item">
          <label>Primary Color (Headings)</label>
          <div class="color-picker-wrapper">
            <input 
              type="color" 
              [(ngModel)]="customization.primaryColor" 
              (input)="onCustomizationChange()"
              class="color-picker">
            <span class="color-value">{{customization.primaryColor}}</span>
          </div>
        </div>

        <div class="setting-item">
          <label>Secondary Color (Accents)</label>
          <div class="color-picker-wrapper">
            <input 
              type="color" 
              [(ngModel)]="customization.secondaryColor" 
              (input)="onCustomizationChange()"
              class="color-picker">
            <span class="color-value">{{customization.secondaryColor}}</span>
          </div>
        </div>

        <div class="setting-item">
          <label>Text Color</label>
          <div class="color-picker-wrapper">
            <input 
              type="color" 
              [(ngModel)]="customization.textColor" 
              (input)="onCustomizationChange()"
              class="color-picker">
            <span class="color-value">{{customization.textColor}}</span>
          </div>
        </div>

        <div class="setting-item">
          <label>Background Color</label>
          <div class="color-picker-wrapper">
            <input 
              type="color" 
              [(ngModel)]="customization.backgroundColor" 
              (input)="onCustomizationChange()"
              class="color-picker">
            <span class="color-value">{{customization.backgroundColor}}</span>
          </div>
        </div>
      </div>

      <!-- Reset Button -->
      <button class="btn-reset" (click)="resetCustomization()">
        <i class="icon-refresh"></i> Reset to Default
      </button>
    </div>
  </div>

  <div class="preview-main" [class.shifted]="showCustomizationPanel">
    <!-- CV Preview -->
    <div class="cv-preview-wrapper" #cvWrapper *ngIf="!isLoading">
      <div class="cv-preview" #cvPreview [innerHTML]="previewHtml" [style.transform]="'scale(' + effectiveScale + ')'">
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Generating preview...</p>
    </div>

    <!-- Quick Edit Shortcuts removed as requested -->
  </div>
</div>